<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting started · LevelSetQuadrature.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://WaveProp.github.io/LevelSetQuadrature.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>LevelSetQuadrature.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Getting started</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Polynomial-domains"><span>Polynomial domains</span></a></li><li><a class="tocitem" href="#Advanced-usage"><span>Advanced usage</span></a></li><li><a class="tocitem" href="#Other-limitations-and-known-issues"><span>Other limitations and known issues</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li><li><a class="tocitem" href="references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Getting started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting started</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/WaveProp/LevelSetQuadrature.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="home-section"><a class="docs-heading-anchor" href="#home-section">LevelSetQuadrature.jl</a><a id="home-section-1"></a><a class="docs-heading-anchor-permalink" href="#home-section" title="Permalink"></a></h1><p><em>High-order quadratures for implicitly defined surfaces</em></p><div class="admonition is-info"><header class="admonition-header">Algorithm and references</header><div class="admonition-body"><p>This package implements, with minor modifications, the algorithms described in:</p><ul><li>Saye 2015</li><li>Saye 2022</li></ul><p>If you find this work useful, please consider citing the original references.  TODO: properly cite.</p></div></div><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This package allows you to generate high-order <em>quadrature nodes</em> and <em>weights</em> for integrating regular functions over <span>$d$</span>-dimensional volumes/surfaces of the form:</p><p class="math-container">\[\Omega = \{\boldsymbol{x} \in U \subset \mathbb{R}^d \quad s.t. \quad  \phi(\boldsymbol{x}) &lt; 0\}, \quad \text{and} \quad \Gamma = \{\boldsymbol{x} \in U \subset \mathbb{R}^d \quad s.t. \quad  \phi(\boldsymbol{x}) = 0\},\]</p><p>where <span>$U$</span> is the bounding box described as a <span>$d$</span>-dimensional rectangle, and <span>$\phi : \mathbb{R}^d \to \mathbb{R}$</span> is a <em>simple Julia function</em> (more on this later). We refer to <span>$\Omega$</span> and <span>$\Gamma$</span> as implicit domains because they are defined <em>implicitly</em> through the function <span>$\phi$</span>. For example, we may describe a disk through</p><pre><code class="language- hljs">using LevelSetQuadrature
using Plots

f   = (x) -&gt; x[1]^2 + x[2]^2 - 1
lb, ub = -1.1, 1.1
# plot
xx = yy = lb:0.05:ub
fig = contour(xx,yy,(x,y) -&gt; f((x,y));levels=[0],aspect_ratio=:equal,cbar=nothing)</code></pre><p>To generate a quadrature for the disk we may then call <a href="references/#LevelSetQuadrature.quadgen-Union{Tuple{N}, Tuple{Function, HyperRectangle{N}, Any}, Tuple{Function, HyperRectangle{N}, Any, Any}} where N"><code>quadgen</code></a> as follows:</p><pre><code class="language- hljs">rec = HyperRectangle((lb,lb),(ub,ub))
x,w = quadgen(f,rec,:interior)
println(&quot;error in area: &quot;, abs(sum(w) - pi))</code></pre><p>This produces the following set of nodes</p><pre><code class="language- hljs">scatter!(fig,PlotPoints(),x,label=&quot;interior nodes&quot;,ms=3,m=:cross)</code></pre><p>Similarly, a surface quadrature can be created by passing <code>:surface</code> instead of <code>:interior</code> as an argument to <a href="references/#LevelSetQuadrature.quadgen-Union{Tuple{N}, Tuple{Function, HyperRectangle{N}, Any}, Tuple{Function, HyperRectangle{N}, Any, Any}} where N"><code>quadgen</code></a>:</p><pre><code class="language- hljs">x,w = quadgen(f,rec,:surface)
println(&quot;error in perimeter:&quot;, abs(sum(w) - 2*pi))</code></pre><pre><code class="language- hljs">scatter!(fig,PlotPoints(),x,label=&quot;surface nodes&quot;,ms=3)</code></pre><p>As long as the implicit function defining the domain is simple enough (e.g. a polynomial), changing the domain should be very straightforward:</p><pre><code class="language- hljs">using LevelSetQuadrature
using Plots
# Cassini oval: https://en.wikipedia.org/wiki/Cassini_oval
const a = 1.1
const c = 1.0
f = (x) -&gt; (x[1]^2 + x[2]^2)^2 - 2*c^2*(x[1]^2 - x[2]^2) - (a^4 - c^4)
# a bounding box
l,u = -1.5,1.5
rec = HyperRectangle((l,l),(u,u))
# generate the quadrature
x,w = quadgen(f,rec,:interior)

# plot the domain and quadrature
xx = yy = l:0.05:u
contour(xx,yy,(x,y) -&gt; f((x,y));levels=[0],aspect_ratio=:equal,cbar=nothing,lw=3)
scatter!(PlotPoints(),x,label=nothing,ms=3)</code></pre><p>There is nothing particularly important about dimension 2 (besides the convenient fact that <em>2d</em> is easy to visualize) – the algorithms implemented are dimension agnostic. Computing a surface quadrature for the unit sphere for instance can be achieved through:</p><pre><code class="language- hljs">using LevelSetQuadrature
using Plots
f = (x) -&gt; sum(x.*x) - 1
l,u = -1.5,1.5
rec = HyperRectangle((l,l,l),(u,u,u))
x,w = quadgen(f,rec,:surface)
println(&quot;error in surface area: &quot;, sum(w) - 4π)</code></pre><pre><code class="language- hljs"># plot the nodes
scatter(PlotPoints(),x,label=nothing,ms=3,m=:cross)</code></pre><p>There are several <code>keyword</code> arguments that can be passed to <code>quadgen</code> which provide further control on the generated quadrature; you should consult the <a href="references/#LevelSetQuadrature.quadgen-Union{Tuple{N}, Tuple{Function, HyperRectangle{N}, Any}, Tuple{Function, HyperRectangle{N}, Any, Any}} where N"><code>quadgen</code></a> documentation for more details.</p><div class="admonition is-warning"><header class="admonition-header">Limitation to simple functions</header><div class="admonition-body"><p>In order to build a high-order quadrature, the algorithm implemented in this package must build rigorous bounds on the implicit function passed and its derivatives. For that purpose, we use the bounded linearization idea of Saye, implemented in the <a href="@ref"><code>Linearization</code></a> type, which performs an operation akin to automatic differentiation in order to propagate the bounds on the linearization of functions. Because we have only implemented a small subset of the &quot;linearization rules&quot;, it is possible/likely that the call <code>quadgen(f,rec)</code> will fail if the algorithm does not manage to propagate the bounds on <code>f</code> and its gradient; that is, if the call <code>f(::Linearization)</code> fails. Feel free to open an issue (or a <code>PR</code>) if <code>quadgen</code> does not work with your <em>simple</em> function.</p></div></div><h2 id="Polynomial-domains"><a class="docs-heading-anchor" href="#Polynomial-domains">Polynomial domains</a><a id="Polynomial-domains-1"></a><a class="docs-heading-anchor-permalink" href="#Polynomial-domains" title="Permalink"></a></h2><p>In the case of polynomial domains ...</p><h2 id="Advanced-usage"><a class="docs-heading-anchor" href="#Advanced-usage">Advanced usage</a><a id="Advanced-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-usage" title="Permalink"></a></h2><h2 id="Other-limitations-and-known-issues"><a class="docs-heading-anchor" href="#Other-limitations-and-known-issues">Other limitations and known issues</a><a id="Other-limitations-and-known-issues-1"></a><a class="docs-heading-anchor-permalink" href="#Other-limitations-and-known-issues" title="Permalink"></a></h2><p>Here are some know limitations of the package:</p><ul><li>Automatic differentiation</li><li>Singular points</li><li></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="references/#LevelSetQuadrature.BernsteinPolynomial"><code>LevelSetQuadrature.BernsteinPolynomial</code></a></li><li><a href="references/#LevelSetQuadrature.GradientDual"><code>LevelSetQuadrature.GradientDual</code></a></li><li><a href="references/#LevelSetQuadrature.ImplicitDomain"><code>LevelSetQuadrature.ImplicitDomain</code></a></li><li><a href="references/#LevelSetQuadrature.LinearizationDual"><code>LevelSetQuadrature.LinearizationDual</code></a></li><li><a href="references/#LevelSetQuadrature.bound-Union{Tuple{D}, Tuple{Function, HyperRectangle{D}}} where D"><code>LevelSetQuadrature.bound</code></a></li><li><a href="references/#LevelSetQuadrature.gradient-Tuple{LevelSetQuadrature.LinearizationDual}"><code>LevelSetQuadrature.gradient</code></a></li><li><a href="references/#LevelSetQuadrature.power2bernstein-Union{Tuple{Array{&lt;:Real, D}}, Tuple{D}, Tuple{Array{&lt;:Real, D}, HyperRectangle{D}}, Tuple{Array{&lt;:Real, D}, HyperRectangle{D}, Any}} where D"><code>LevelSetQuadrature.power2bernstein</code></a></li><li><a href="references/#LevelSetQuadrature.prune!-Tuple{LevelSetQuadrature.AbstractDomain}"><code>LevelSetQuadrature.prune!</code></a></li><li><a href="references/#LevelSetQuadrature.quadgen-Union{Tuple{N}, Tuple{Function, HyperRectangle{N}, Any}, Tuple{Function, HyperRectangle{N}, Any, Any}} where N"><code>LevelSetQuadrature.quadgen</code></a></li><li><a href="references/#LevelSetQuadrature.reference_cube-Union{Tuple{Val{D}}, Tuple{D}} where D"><code>LevelSetQuadrature.reference_cube</code></a></li><li><a href="references/#LevelSetQuadrature.remainder-Tuple{LevelSetQuadrature.LinearizationDual}"><code>LevelSetQuadrature.remainder</code></a></li><li><a href="references/#LevelSetQuadrature.sgn-NTuple{4, Any}"><code>LevelSetQuadrature.sgn</code></a></li><li><a href="references/#LevelSetQuadrature.tensorquad-Union{Tuple{D}, Tuple{HyperRectangle{D}, Any, Any}} where D"><code>LevelSetQuadrature.tensorquad</code></a></li><li><a href="references/#LevelSetQuadrature.value-Tuple{LevelSetQuadrature.LinearizationDual}"><code>LevelSetQuadrature.value</code></a></li><li><a href="references/#WavePropBase.domain-Tuple{LevelSetQuadrature.LinearizationDual}"><code>WavePropBase.domain</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Wednesday 8 June 2022 14:24">Wednesday 8 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
